{"version":3,"sources":["webpack:///src/app/pages/navigation/ongoing/cancel/cancel.page.html","webpack:///src/app/pages/navigation/ongoing/cancel/cancel-routing.module.ts","webpack:///src/app/pages/navigation/ongoing/cancel/cancel.module.ts","webpack:///src/app/pages/navigation/ongoing/cancel/cancel.page.scss","webpack:///src/app/pages/navigation/ongoing/cancel/cancel.page.ts"],"names":["routes","path","component","CancelPageRoutingModule","imports","forChild","exports","CancelPageModule","declarations","CancelPage","dealService","notiService","router","route","afAuth","authState","date","Math","floor","Date","getTime","id","snapshot","paramMap","get","getUser","subscribe","userId","uid","updateDeal","status","updateDate","createCancelDeal","result","reason","message","cancelDate","dealerId","requestId","createNoti","getParticipantById","val","forEach","part","deleteParticipant","payload","doc","updateDealInDealer","participants","created","navigate","selector","template"],"mappings":"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","file":"cancel-cancel-module-es5.js","sourcesContent":["export default \"<ion-header>\\n\\t<ion-toolbar>\\n\\t\\t<ion-buttons slot=\\\"start\\\">\\n\\t\\t\\t<ion-back-button></ion-back-button>\\n\\t\\t</ion-buttons>\\n\\t\\t<ion-title>Cancel</ion-title>\\n\\t</ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-padding\\\">\\n\\t<ion-item class=\\\"mt-10\\\">\\n\\t\\t<ion-label position=\\\"floating\\\">Cancel Reason</ion-label>\\n\\t\\t<ion-textarea [(ngModel)]=\\\"message\\\" class=\\\"cancel-input\\\"></ion-textarea>\\n\\t</ion-item>\\n\\t<ion-button\\n\\t\\tclass=\\\"mt-5\\\"\\n\\t\\texpand=\\\"block\\\"\\n\\t\\tcolor=\\\"primary\\\"\\n\\t\\t(click)=\\\"submitCancel()\\\"\\n\\t>\\n\\t\\tSubmit\\n\\t</ion-button>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CancelPage } from './cancel.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CancelPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CancelPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CancelPageRoutingModule } from './cancel-routing.module';\n\nimport { CancelPage } from './cancel.page';\n\n@NgModule({\n\timports: [CommonModule, FormsModule, IonicModule, CancelPageRoutingModule],\n\tdeclarations: [CancelPage],\n})\nexport class CancelPageModule {}\n","export default \".cancel-input > div > textarea {\\n  min-height: 15rem !important;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbmF2aWdhdGlvbi9vbmdvaW5nL2NhbmNlbC9jYW5jZWwucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVFO0VBQ0MsNEJBQUE7QUFESCIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL25hdmlnYXRpb24vb25nb2luZy9jYW5jZWwvY2FuY2VsLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5jYW5jZWwtaW5wdXQge1xuXHQmID4gZGl2IHtcblx0XHQmID4gdGV4dGFyZWEge1xuXHRcdFx0bWluLWhlaWdodDogMTVyZW0gIWltcG9ydGFudDtcblx0XHR9XG5cdH1cbn1cbiJdfQ== */\";","import { AngularFireAuth } from '@angular/fire/auth';\nimport { NotiService } from './../../../../services/noti.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { DealsService } from 'src/app/services/deals.service';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n\tselector: 'app-cancel',\n\ttemplateUrl: './cancel.page.html',\n\tstyleUrls: ['./cancel.page.scss'],\n})\nexport class CancelPage implements OnInit {\n\tid: string;\n\tmessage: string;\n\n\tuserId: string;\n\tauthState: any = null;\n\n\tdate = Math.floor(new Date().getTime() / 1000.0);\n\n\tconstructor(\n\t\tprivate dealService: DealsService,\n\t\tprivate notiService: NotiService,\n\t\tprivate router: Router,\n\t\tprivate route: ActivatedRoute,\n\t\tprivate afAuth: AngularFireAuth\n\t) {\n\t\tthis.id = this.route.snapshot.paramMap.get('id'); //get id parameter\n\t}\n\n\tngOnInit() {\n\t\tthis.getUser();\n\t}\n\n\tasync getUser() {\n\t\tawait this.afAuth.authState.subscribe((authState) => {\n\t\t\tthis.authState = authState;\n\t\t\tif (this.authState) {\n\t\t\t\tthis.userId = this.authState.uid;\n\t\t\t}\n\t\t});\n\t}\n\n\tasync submitCancel() {\n\t\tawait this.dealService.updateDeal(this.id, {\n\t\t\tstatus: 4,\n\t\t\tupdateDate: this.date,\n\t\t});\n\t\tawait this.dealService.createCancelDeal({\n\t\t\tresult: 'Cancel',\n\t\t\treason: this.message,\n\t\t\tcancelDate: this.date,\n\t\t\tdealerId: this.userId,\n\t\t\trequestId: this.id,\n\t\t});\n\t\tawait this.notiService.createNoti({\n\t\t\trequestId: this.id,\n\t\t\tstatus: 4,\n\t\t\tupdateDate: this.userId,\n\t\t});\n\t\tawait this.dealService\n\t\t\t.getParticipantById(this.id, this.userId)\n\t\t\t.subscribe((val) => {\n\t\t\t\tval.forEach((part) => {\n\t\t\t\t\tthis.dealService.deleteParticipant(this.id, part.payload.doc.id);\n\t\t\t\t});\n\t\t\t});\n\t\tawait this.dealService.updateDealInDealer(this.id, { status: 'Cancel' });\n\t\tawait this.dealService.updateDeal(this.id, {\n\t\t\tparticipants: { created: false },\n\t\t});\n\t\tthis.router.navigate(['/', 'home', 'deal']);\n\t}\n}\n"]}